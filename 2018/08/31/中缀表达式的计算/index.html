<!DOCTYPE HTML><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="google-site-verification" content=""><title>中缀表达式的计算</title><meta name="author" content="yidreamc"><meta name="description" content="常见的算式比如2+3、4*5+2这种都是中缀表达式，特点是运算符在操作数的中间，这种表达式对人来说还是比较有好的，但对于程序来说就不太有好了，因为运算符号包含了优先级，而且还有括号先计算这些规则。首先声明一下，这种表达式只是不太友好，并不是不能用程序直接做，只是相对于而言稍微困难一点。比较常见一点的"><meta property="og:title" content="中缀表达式的计算"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:site_name" content="追梦"><link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed"><link rel="alternate" href="/atom.xml" title="追梦" type="application/atom+xml"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/m.min.css"><link rel="icon" type="image/x-icon" href="/favicon.ico"></head><body><a id="top"></a><div id="main"><div class="behind"> <a href="/" class="back black-color"><svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"><path d="M2 30 30 2M30 30 2 2"></path></svg></a><div class="description"> &nbsp;</div></div><div class="container"><article class="standard post"><div class="title"><h1 class="page-title center"> 中缀表达式的计算</h1></div><div class="meta center"> <time datetime="2018-08-31T17:59:52.000Z"><svg class="i-calendar" viewBox="0 0 32 32" width="14" height="14" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M2 6 2 30 30 30 30 6ZM2 15 30 15M7 3 7 9M13 3 13 9M19 3 19 9M25 3 25 9"></path></svg>&nbsp; 2018-08-31</time></div><hr><div class="picture-container"></div><p>常见的算式比如<code>2+3</code>、<code>4*5+2</code>这种都是中缀表达式，特点是运算符在操作数的中间，这种表达式对人来说还是比较有好的，但对于程序来说就不太有好了，因为运算符号包含了优先级，而且还有括号先计算这些规则。首先声明一下，这种表达式只是不太友好，并不是不能用程序直接做，只是相对于而言稍微困难一点。<br>比较常见一点的做法就是转换成后缀表达式来进行计算，因为中缀表达式转换为后缀表达式很简单，而后缀表达式的计算比较符合程序的逻辑，比较好做。</p><h3 id="常规做法"><a href="#常规做法" class="headerlink" title="常规做法"></a>常规做法</h3><p>中缀表达式转换为后缀表达式，然后计算后缀表达式<br>中缀表达式转换为后缀表达式规则如下<br>有一个符号栈，一个输出列</p><ul><li>当遇到一个左括号时立即将其压栈</li><li>当遇到对应的右括号时，将栈中的操作符弹出并输出，直到遇到左括号。最后再弹出左括号，括号不输出</li><li>当遇到一个数时，直接输出</li><li>当遇到操作符，将他与栈顶操作符比较<ul><li>如果它比栈顶的操作符优先级高，或者它是左括号后的第一个操作符，则将其压入栈</li><li>如果优先级低或相等，将栈顶元素弹出并输出</li></ul></li></ul><p>计算后缀表达式方法如下</p><ol><li>建立一个栈，顺序遍历上面的输出列</li><li>遇到操作数压栈</li><li>遇到操作符则弹出栈顶的两个数，并进行计算，并将结果压栈</li></ol><p><a href="https://github.com/yidreamc/ts-lib/tree/master/calc" target="_blank" rel="noopener">ts实现</a></p><h3 id="直接计算"><a href="#直接计算" class="headerlink" title="直接计算"></a>直接计算</h3><p>直接计算也是可以的，计算规则如下<br>构建两个栈，数栈（存放数和左括号）和操作符栈</p><ol><li>如果是数字，<ol><li>操作符栈为空，或栈顶为加或减，则压入数栈</li><li>操作符栈为乘除，则加入数栈，判断数栈中倒数第2个元素是否为数字，<ol><li>若是，则进行计算，并将结果加入到数栈中</li><li>若不是数字（而是左括号）则继续后续遍历</li></ol></li></ol></li><li>如果是操作符，入操作符栈</li><li>如果是左边括号，入数栈</li><li>如果是右边括号：查找左括号在数栈中的位置，表达式中左括号后面首个操作符在操作栈中的位置，计算括号内部结果，用结果代替左括号的位置，然后判断前面的操作符是否为乘除，若是，则继续计算</li><li>最后剩下加减表达式，这时再来一次加减计算：从左到右遍历计算</li></ol><p><code>1 + 2 * ( 3 + 4 * 5 )</code></p><table><thead><tr><th>步骤</th><th>数栈</th><th>操作栈</th></tr></thead><tbody><tr><td>1</td><td>1</td><td></td></tr><tr><td>2</td><td>1</td><td>+</td></tr><tr><td>3</td><td>1,2</td><td>+</td></tr><tr><td>4</td><td>1,2</td><td>+,*</td></tr><tr><td>5</td><td>1,2,(</td><td>+,*</td></tr><tr><td>6</td><td>1,2,(,3</td><td>+,*</td></tr><tr><td>7</td><td>1,2,(,3</td><td>+,*+</td></tr><tr><td>8</td><td>1,2,(,3,4</td><td>+,*+</td></tr><tr><td>9</td><td>1,2,(,3,4</td><td>+,*,+,*</td></tr><tr><td>10</td><td>1,2,(,3,4,5</td><td>+,*,+,*</td></tr><tr><td>11</td><td>1,2,(,3,20</td><td>+,*,+</td></tr><tr><td>12</td><td>1,2,23</td><td>+,*</td></tr><tr><td>13</td><td>1,46</td><td>+</td></tr><tr><td>14</td><td>47</td><td></td></tr></tbody></table></article><script async src="/js/busuanzi.pure.mini.js"></script><div class="busuanzi center"> page PV:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp; site PV:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp; site UV:&nbsp;<span id="busuanzi_value_site_uv"></span></div></div></div><footer class="page-footer"><div class="clearfix"></div><div class="clearfix"></div></footer><script src="/js/jquery.min.js"></script><script src="/js/search.min.js"></script><script type="text/javascript">$(".dropdown").click(function(o){var n=$(this);o.stopPropagation(),$(n).children(".dropdown-content")[$(n).children(".dropdown-content").hasClass("open")?"removeClass":"addClass"]("open")}),$(document).click(function(){$(".dropdown-content").removeClass("open")});var path="/search.xml";searchFunc(path,"local-search-input","local-search-result")</script></body></html>