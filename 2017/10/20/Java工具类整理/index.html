<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>Java工具类整理</title>
  <meta name="author" content="xmfaly">
  <meta name="description" content="以下整理常用的java工具类。
二维码生成和解析(网上很多接口也很方便)使用google的zxing12345&amp;lt;dependency&amp;gt;	&amp;lt;groupId&amp;gt;com.google.zxing&amp;lt;/groupId&amp;gt;	&amp;lt;artifactId&amp;gt;javase&amp;lt;">
  
  
  <meta property="og:title" content="Java工具类整理"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="惜凡"/>
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="惜凡" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <a id="top"></a>
  <div id="main">
    <div class="behind">
      <a href="/" class="back black-color">
        <svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
            <path d="M2 30 L30 2 M30 30 L2 2"></path>
        </svg>
      </a>
      <div class="description">
        &nbsp;
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        Java工具类整理
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2017-10-20T07:50:16.000Z">
<svg class="i-calendar" viewBox="0 0 32 32" width="14" height="14" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
    <path d="M2 6 L2 30 30 30 30 6 Z M2 15 L30 15 M7 3 L7 9 M13 3 L13 9 M19 3 L19 9 M25 3 L25 9"></path>
  </svg>
  &nbsp;
  2017-10-20
</time>






    
    &nbsp;
    <svg class="i-tag" viewBox="0 0 32 32" width="14" height="14" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      <circle cx="24" cy="8" r="2"></circle>
      <path d="M2 18 L18 2 30 2 30 14 14 30 Z"></path>
    </svg>
    &nbsp;
    <a href="/tags/java/">java</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <p>以下整理常用的java工具类。</p>
<h3 id="二维码生成和解析-网上很多接口也很方便"><a href="#二维码生成和解析-网上很多接口也很方便" class="headerlink" title="二维码生成和解析(网上很多接口也很方便)"></a>二维码生成和解析(网上很多接口也很方便)</h3><p>使用google的zxing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;dependency&gt;</div><div class="line">	&lt;groupId&gt;com.google.zxing&lt;/groupId&gt;</div><div class="line">	&lt;artifactId&gt;javase&lt;/artifactId&gt;</div><div class="line">	&lt;version&gt;3.3.0&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>
<p>工具类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div></pre></td><td class="code"><pre><div class="line">import com.google.zxing.*;</div><div class="line">import com.google.zxing.Reader;</div><div class="line">import com.google.zxing.client.j2se.BufferedImageLuminanceSource;</div><div class="line">import com.google.zxing.client.j2se.MatrixToImageWriter;</div><div class="line">import com.google.zxing.common.BitMatrix;</div><div class="line">import com.google.zxing.common.HybridBinarizer;</div><div class="line">import com.google.zxing.multi.GenericMultipleBarcodeReader;</div><div class="line">import com.google.zxing.multi.MultipleBarcodeReader;</div><div class="line"></div><div class="line">import javax.imageio.ImageIO;</div><div class="line">import java.io.*;</div><div class="line">import java.nio.file.FileSystems;</div><div class="line">import java.nio.file.Path;</div><div class="line">import java.util.*;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 二维码生成工具类</div><div class="line"> *</div><div class="line"> * @author KisChang</div><div class="line"> * @version 1.0</div><div class="line"> * @date 2015年12月03日</div><div class="line"> * @since 1.0</div><div class="line"> */</div><div class="line">public class ZXingUtils &#123;</div><div class="line"></div><div class="line">    public static enum ImageType &#123;</div><div class="line">        JPEG(&quot;jpeg&quot;),PNG(&quot;png&quot;),GIF(&quot;gif&quot;);</div><div class="line">        private String value;</div><div class="line"></div><div class="line">        ImageType(String value) &#123;</div><div class="line">            this.value = value;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public String getValue() &#123;</div><div class="line">            return value;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**编码*/</div><div class="line">    public static class Encode &#123;</div><div class="line"></div><div class="line">        private static Map&lt;EncodeHintType, Object&gt; HINTS;</div><div class="line">        static &#123;</div><div class="line">            HINTS = new EnumMap&lt;EncodeHintType,Object&gt;(EncodeHintType.class);</div><div class="line">            HINTS.put(EncodeHintType.CHARACTER_SET, &quot;UTF-8&quot;);</div><div class="line">        &#125;</div><div class="line">        /**</div><div class="line">         * 生成二维码</div><div class="line">         * @param widthAndHeight    高宽</div><div class="line">         * @param content           二维码内容</div><div class="line">         * @param os                输出流</div><div class="line">         */</div><div class="line">        public static void buildQRCode(int widthAndHeight, String content, OutputStream os, ImageType imageType) throws WriterException, IOException &#123;</div><div class="line">            BitMatrix bitMatrix = new MultiFormatWriter().encode(content, BarcodeFormat.QR_CODE, widthAndHeight, widthAndHeight, HINTS);// 生成矩阵</div><div class="line">            MatrixToImageWriter.writeToStream(bitMatrix, imageType.getValue(), os);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public static void buildQRCode(String content, OutputStream os, ImageType imageType) throws WriterException, IOException &#123;</div><div class="line">            buildQRCode(200, content, os, imageType);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        /**</div><div class="line">         * 生成二维码</div><div class="line">         * @param widthAndHeight    高宽</div><div class="line">         * @param content           二维码内容</div><div class="line">         * @param filePath          输出目录</div><div class="line">         * @param fileName          输出文件名</div><div class="line">         * @param imageType         输出文件类型</div><div class="line">         */</div><div class="line">        public static void buildQRCode(int widthAndHeight, String content, String filePath, String fileName, ImageType imageType) throws WriterException, IOException &#123;</div><div class="line">            BitMatrix bitMatrix = new MultiFormatWriter().encode(content,</div><div class="line">                    BarcodeFormat.QR_CODE, widthAndHeight, widthAndHeight, HINTS);</div><div class="line">            Path path = FileSystems.getDefault().getPath(filePath, fileName);</div><div class="line">            MatrixToImageWriter.writeToPath(bitMatrix, imageType.getValue(), path);// 输出图像</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public static void buildQRCode(String content, String filePath, String fileName, ImageType imageType) throws WriterException, IOException &#123;</div><div class="line">            buildQRCode(200, content,filePath,fileName,imageType);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /**解码*/</div><div class="line">    public static class Decode &#123;</div><div class="line"></div><div class="line">        private static final Map&lt;DecodeHintType,Object&gt; HINTS;</div><div class="line">        private static final Map&lt;DecodeHintType,Object&gt; HINTS_PURE;</div><div class="line">        static &#123;</div><div class="line">            HINTS = new EnumMap&lt;DecodeHintType,Object&gt;(DecodeHintType.class);</div><div class="line">            HINTS.put(DecodeHintType.TRY_HARDER, Boolean.TRUE);</div><div class="line">            HINTS.put(DecodeHintType.POSSIBLE_FORMATS, EnumSet.allOf(BarcodeFormat.class));</div><div class="line">            HINTS_PURE = new EnumMap&lt;DecodeHintType,Object&gt;(HINTS);</div><div class="line">            HINTS_PURE.put(DecodeHintType.PURE_BARCODE, Boolean.TRUE);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        /**</div><div class="line">         * 解析二维码</div><div class="line">         */</div><div class="line">        public static Collection&lt;Result&gt; readQRCode(File qrCode) throws ReaderException, IOException &#123;</div><div class="line">            FileInputStream inputStream = new FileInputStream(qrCode);</div><div class="line">            return readQRCode(inputStream);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        public static Collection&lt;Result&gt; readQRCode(InputStream inputStream) throws ReaderException, IOException &#123;</div><div class="line">            LuminanceSource source = new BufferedImageLuminanceSource(ImageIO.read(inputStream));</div><div class="line">            BinaryBitmap binaryBitmap = new BinaryBitmap(new HybridBinarizer(source));</div><div class="line"></div><div class="line">            Collection&lt;Result&gt; results = new ArrayList&lt;Result&gt;(1);</div><div class="line">            ReaderException savedException = null;</div><div class="line">            Reader reader = new MultiFormatReader();</div><div class="line">            try &#123;</div><div class="line">                //寻找多个条码</div><div class="line">                MultipleBarcodeReader multiReader = new GenericMultipleBarcodeReader(reader);</div><div class="line">                Result[] theResults = multiReader.decodeMultiple(binaryBitmap, HINTS);</div><div class="line">                if (theResults != null) &#123;</div><div class="line">                    results.addAll(Arrays.asList(theResults));</div><div class="line">                &#125;</div><div class="line">            &#125; catch (ReaderException re) &#123;</div><div class="line">                savedException = re;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if (results.isEmpty()) &#123;</div><div class="line">                try &#123;</div><div class="line">                    //寻找纯条码</div><div class="line">                    Result theResult = reader.decode(binaryBitmap, HINTS_PURE);</div><div class="line">                    if (theResult != null) &#123;</div><div class="line">                        results.add(theResult);</div><div class="line">                    &#125;</div><div class="line">                &#125; catch (ReaderException re) &#123;</div><div class="line">                    savedException = re;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if (results.isEmpty()) &#123;</div><div class="line">                try &#123;</div><div class="line">                    //寻找图片中的正常条码</div><div class="line">                    Result theResult = reader.decode(binaryBitmap, HINTS);</div><div class="line">                    if (theResult != null) &#123;</div><div class="line">                        results.add(theResult);</div><div class="line">                    &#125;</div><div class="line">                &#125; catch (ReaderException re) &#123;</div><div class="line">                    savedException = re;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if (results.isEmpty()) &#123;</div><div class="line">                try &#123;</div><div class="line">                    //再次尝试其他特殊处理</div><div class="line">                    BinaryBitmap hybridBitmap = new BinaryBitmap(new HybridBinarizer(source));</div><div class="line">                    Result theResult = reader.decode(hybridBitmap, HINTS);</div><div class="line">                    if (theResult != null) &#123;</div><div class="line">                        results.add(theResult);</div><div class="line">                    &#125;</div><div class="line">                &#125; catch (ReaderException re) &#123;</div><div class="line">                    savedException = re;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            if (results.isEmpty())&#123;</div><div class="line">                throw savedException;</div><div class="line">            &#125;else &#123;</div><div class="line">                return results;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        public static Result readQRCodeResult(File qrCode) throws ReaderException, IOException &#123;</div><div class="line">            FileInputStream inputStream = new FileInputStream(qrCode);</div><div class="line">            return readQRCodeResult(inputStream);</div><div class="line">        &#125;</div><div class="line">        public static Result readQRCodeResult(InputStream inputStream) throws ReaderException, IOException &#123;</div><div class="line">            Collection&lt;Result&gt; results = readQRCode(inputStream);</div><div class="line">            if (!results.isEmpty())&#123;</div><div class="line">                //寻找结果集中非空的结果</div><div class="line">                for (Result result : results)&#123;</div><div class="line">                    if (result != null)&#123;</div><div class="line">                        return result;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            throw NotFoundException.getNotFoundInstance();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="MD5加密"><a href="#MD5加密" class="headerlink" title="MD5加密"></a>MD5加密</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">import java.math.BigInteger;</div><div class="line">import java.security.MessageDigest;</div><div class="line">import java.security.NoSuchAlgorithmException;</div><div class="line"></div><div class="line">public class MD5 &#123;</div><div class="line"></div><div class="line">    public static String getMD5(String str) throws NoSuchAlgorithmException &#123;</div><div class="line"></div><div class="line">        // 生成一个MD5加密计算摘要</div><div class="line">        MessageDigest md = MessageDigest.getInstance(&quot;MD5&quot;);</div><div class="line">        // 计算md5函数</div><div class="line">        md.update(str.getBytes());</div><div class="line">        // digest()最后确定返回md5 hash值，返回值为8为字符串。因为md5 hash值是16位的hex值，实际上就是8位的字符</div><div class="line">        // BigInteger函数则将8位的字符串转换成16位hex值，用字符串来表示；得到字符串形式的hash值</div><div class="line">        return new BigInteger(1, md.digest()).toString(16);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="读取excel"><a href="#读取excel" class="headerlink" title="读取excel"></a>读取excel</h3><p>依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi --&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;3.17-beta1&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div><div class="line">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml --&gt;</div><div class="line">&lt;dependency&gt;</div><div class="line">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</div><div class="line">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</div><div class="line">    &lt;version&gt;3.16-beta1&lt;/version&gt;</div><div class="line">&lt;/dependency&gt;</div></pre></td></tr></table></figure></p>
<p>工具类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div></pre></td><td class="code"><pre><div class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</div><div class="line">import org.apache.poi.ss.usermodel.*;</div><div class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</div><div class="line">import org.slf4j.Logger;</div><div class="line">import org.slf4j.LoggerFactory;</div><div class="line">import java.io.FileInputStream;</div><div class="line">import java.io.FileNotFoundException;</div><div class="line">import java.io.IOException;</div><div class="line">import java.io.InputStream;</div><div class="line">import java.text.DecimalFormat;</div><div class="line">import java.text.SimpleDateFormat;</div><div class="line">import java.util.Date;</div><div class="line">import java.util.HashMap;</div><div class="line">import java.util.Map;</div><div class="line">public class ReadExcelUtils &#123;</div><div class="line"></div><div class="line">    private Logger logger = LoggerFactory.getLogger(this.getClass());</div><div class="line">    private Workbook wb;</div><div class="line">    private Sheet sheet;</div><div class="line">    private Row row;</div><div class="line">    public ReadExcelUtils(String filepath) &#123;</div><div class="line">        if(filepath==null)&#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        String ext = filepath.substring(filepath.lastIndexOf(&quot;.&quot;));</div><div class="line">        try &#123;</div><div class="line">            InputStream is = new FileInputStream(filepath);</div><div class="line">            if(&quot;.xls&quot;.equals(ext))&#123;</div><div class="line">                wb = new HSSFWorkbook(is);</div><div class="line">            &#125;else if(&quot;.xlsx&quot;.equals(ext))&#123;</div><div class="line">                wb = new XSSFWorkbook(is);</div><div class="line">            &#125;else&#123;</div><div class="line">                wb=null;</div><div class="line">            &#125;</div><div class="line">        &#125; catch (FileNotFoundException e) &#123;</div><div class="line">            logger.error(&quot;FileNotFoundException&quot;, e);</div><div class="line">        &#125; catch (IOException e) &#123;</div><div class="line">            logger.error(&quot;IOException&quot;, e);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    /**</div><div class="line">     * 读取Excel表格表头的内容</div><div class="line">     * @return String 表头内容的数组</div><div class="line">     */</div><div class="line">    public String[] readExcelTitle() throws Exception&#123;</div><div class="line">        if(wb==null)&#123;</div><div class="line">            throw new Exception(&quot;Workbook对象为空！&quot;);</div><div class="line">        &#125;</div><div class="line">        sheet = wb.getSheetAt(0);</div><div class="line">        row = sheet.getRow(0);</div><div class="line">        // 标题总列数</div><div class="line">        int colNum = row.getPhysicalNumberOfCells();</div><div class="line">        String[] title = new String[colNum];</div><div class="line">        for (int i = 0; i &lt; colNum; i++) &#123;</div><div class="line">            // title[i] = getStringCellValue(row.getCell((short) i));</div><div class="line">            title[i] = row.getCell(i).getStringCellValue();</div><div class="line">        &#125;</div><div class="line">        return title;</div><div class="line">    &#125;</div><div class="line">    /**</div><div class="line">     * 读取Excel数据内容</div><div class="line">     * @return Map 包含单元格数据内容的Map对象</div><div class="line">     */</div><div class="line">    public Map&lt;Integer, Map&lt;Integer,Object&gt;&gt; readExcelContent() throws Exception&#123;</div><div class="line">        if(wb==null)&#123;</div><div class="line">            throw new Exception(&quot;Workbook对象为空！&quot;);</div><div class="line">        &#125;</div><div class="line">        Map&lt;Integer, Map&lt;Integer,Object&gt;&gt; content = new HashMap&lt;Integer, Map&lt;Integer,Object&gt;&gt;();</div><div class="line">        sheet = wb.getSheetAt(0);</div><div class="line">        // 得到总行数</div><div class="line">        int rowNum = sheet.getLastRowNum();</div><div class="line">        row = sheet.getRow(0);</div><div class="line">        int colNum = row.getPhysicalNumberOfCells();</div><div class="line">        // 正文内容应该从第二行开始,第一行为表头的标题</div><div class="line">        for (int i = 1; i &lt;= rowNum; i++) &#123;</div><div class="line">            row = sheet.getRow(i);</div><div class="line">            int j = 0;</div><div class="line">            Map&lt;Integer,Object&gt; cellValue = new HashMap&lt;Integer, Object&gt;();</div><div class="line">            while (j &lt; colNum) &#123;</div><div class="line">                Object obj = getCellFormatValue(row.getCell(j));</div><div class="line">                cellValue.put(j, obj);</div><div class="line">                j++;</div><div class="line">            &#125;</div><div class="line">            content.put(i, cellValue);</div><div class="line">        &#125;</div><div class="line">        return content;</div><div class="line">    &#125;</div><div class="line">    /**</div><div class="line">     * 根据Cell类型设置数据</div><div class="line">     * @param cell</div><div class="line">     * @return Object</div><div class="line">     */</div><div class="line">    private Object getCellFormatValue(Cell cell) &#123;</div><div class="line">        Object cellvalue = &quot;&quot;;</div><div class="line">        if (cell != null) &#123;</div><div class="line">            // 判断当前Cell的Type</div><div class="line">            switch (cell.getCellType()) &#123;</div><div class="line">                case Cell.CELL_TYPE_NUMERIC:// 如果当前Cell的Type为NUMERIC</div><div class="line">                case Cell.CELL_TYPE_FORMULA: &#123;</div><div class="line">                    // 判断当前的cell是否为Date</div><div class="line">                    if (DateUtil.isCellDateFormatted(cell)) &#123;</div><div class="line">                        Date date = cell.getDateCellValue();</div><div class="line">                        SimpleDateFormat dateformat=new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</div><div class="line">                        cellvalue = dateformat.format(date);</div><div class="line"></div><div class="line">                    &#125; else &#123;</div><div class="line">                        // 如果是纯数字</div><div class="line">                        // 取得当前Cell的数值</div><div class="line">                        DecimalFormat df = new DecimalFormat(&quot;0&quot;);</div><div class="line">                        cellvalue = df.format(cell.getNumericCellValue());</div><div class="line">                    &#125;</div><div class="line">                    break;</div><div class="line">                &#125;</div><div class="line">                case Cell.CELL_TYPE_STRING:// 如果当前Cell的Type为STRING</div><div class="line">                    // 取得当前的Cell字符串</div><div class="line">                    cellvalue = cell.getRichStringCellValue().getString();</div><div class="line">                    break;</div><div class="line">                default:// 默认的Cell值</div><div class="line">                    cellvalue = &quot;&quot;;</div><div class="line">            &#125;</div><div class="line">        &#125; else &#123;</div><div class="line">            cellvalue = &quot;&quot;;</div><div class="line">        &#125;</div><div class="line">        return cellvalue;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="加密工具类"><a href="#加密工具类" class="headerlink" title="加密工具类"></a>加密工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line">import java.security.Key;</div><div class="line">import java.security.spec.AlgorithmParameterSpec;</div><div class="line"></div><div class="line">import javax.crypto.Cipher;</div><div class="line">import javax.crypto.SecretKeyFactory;</div><div class="line">import javax.crypto.spec.DESKeySpec;</div><div class="line">import javax.crypto.spec.IvParameterSpec;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 加密解密工具包</div><div class="line"> */</div><div class="line">public class CyptoUtils &#123;</div><div class="line"></div><div class="line">    public static final String ALGORITHM_DES = &quot;DES/CBC/PKCS5Padding&quot;;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * DES算法，加密</div><div class="line">     *</div><div class="line">     * @param data 待加密字符串</div><div class="line">     * @param key  加密私钥，长度不能够小于8位</div><div class="line">     * @return 加密后的字节数组，一般结合Base64编码使用</div><div class="line">     * @throws Exception</div><div class="line">     */</div><div class="line">    public static String encode(String key,String data) &#123;</div><div class="line">        if(data == null)</div><div class="line">            return null;</div><div class="line">        try&#123;</div><div class="line">            DESKeySpec dks = new DESKeySpec(key.getBytes());</div><div class="line">            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;DES&quot;);</div><div class="line">            //key的长度不能够小于8位字节</div><div class="line">            Key secretKey = keyFactory.generateSecret(dks);</div><div class="line">            Cipher cipher = Cipher.getInstance(ALGORITHM_DES);</div><div class="line">            IvParameterSpec iv = new IvParameterSpec(&quot;12345678&quot;.getBytes());</div><div class="line">            AlgorithmParameterSpec paramSpec = iv;</div><div class="line">            cipher.init(Cipher.ENCRYPT_MODE, secretKey,paramSpec);</div><div class="line">            byte[] bytes = cipher.doFinal(data.getBytes());</div><div class="line">            return byte2hex(bytes);</div><div class="line">        &#125;catch(Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            return data;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * DES算法，解密</div><div class="line">     *</div><div class="line">     * @param data 待解密字符串</div><div class="line">     * @param key  解密私钥，长度不能够小于8位</div><div class="line">     * @return 解密后的字节数组</div><div class="line">     * @throws Exception 异常</div><div class="line">     */</div><div class="line">    public static String decode(String key,String data) &#123;</div><div class="line">        if(data == null)</div><div class="line">            return null;</div><div class="line">        try &#123;</div><div class="line">            DESKeySpec dks = new DESKeySpec(key.getBytes());</div><div class="line">            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;DES&quot;);</div><div class="line">            //key的长度不能够小于8位字节</div><div class="line">            Key secretKey = keyFactory.generateSecret(dks);</div><div class="line">            Cipher cipher = Cipher.getInstance(ALGORITHM_DES);</div><div class="line">            IvParameterSpec iv = new IvParameterSpec(&quot;12345678&quot;.getBytes());</div><div class="line">            AlgorithmParameterSpec paramSpec = iv;</div><div class="line">            cipher.init(Cipher.DECRYPT_MODE, secretKey, paramSpec);</div><div class="line">            return new String(cipher.doFinal(hex2byte(data.getBytes())));</div><div class="line">        &#125; catch (Exception e)&#123;</div><div class="line">            e.printStackTrace();</div><div class="line">            return data;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 二行制转字符串</div><div class="line">     * @param b</div><div class="line">     * @return</div><div class="line">     */</div><div class="line">    private static String byte2hex(byte[] b) &#123;</div><div class="line">        StringBuilder hs = new StringBuilder();</div><div class="line">        String stmp;</div><div class="line">        for (int n = 0; b!=null &amp;&amp; n &lt; b.length; n++) &#123;</div><div class="line">            stmp = Integer.toHexString(b[n] &amp; 0XFF);</div><div class="line">            if (stmp.length() == 1)</div><div class="line">                hs.append(&apos;0&apos;);</div><div class="line">            hs.append(stmp);</div><div class="line">        &#125;</div><div class="line">        return hs.toString().toUpperCase();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private static byte[] hex2byte(byte[] b) &#123;</div><div class="line">        if((b.length%2)!=0)</div><div class="line">            throw new IllegalArgumentException();</div><div class="line">        byte[] b2 = new byte[b.length/2];</div><div class="line">        for (int n = 0; n &lt; b.length; n+=2) &#123;</div><div class="line">            String item = new String(b,n,2);</div><div class="line">            b2[n/2] = (byte)Integer.parseInt(item,16);</div><div class="line">        &#125;</div><div class="line">        return b2;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="压缩解压"><a href="#压缩解压" class="headerlink" title="压缩解压"></a>压缩解压</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line">import java.io.*;</div><div class="line">import java.util.Enumeration;</div><div class="line">import java.util.zip.*;</div><div class="line"></div><div class="line">public class CompressUtil &#123;</div><div class="line"></div><div class="line"></div><div class="line">    static final int BUFFER = 8192;</div><div class="line"></div><div class="line">    public static void compress(String srcPath , String dstPath) throws IOException &#123;</div><div class="line">        File srcFile = new File(srcPath);</div><div class="line">        File dstFile = new File(dstPath);</div><div class="line">        if (!srcFile.exists()) &#123;</div><div class="line">            throw new FileNotFoundException(srcPath + &quot;不存在！&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        FileOutputStream out = null;</div><div class="line">        ZipOutputStream zipOut = null;</div><div class="line">        try &#123;</div><div class="line">            out = new FileOutputStream(dstFile);</div><div class="line">            CheckedOutputStream cos = new CheckedOutputStream(out,new CRC32());</div><div class="line">            zipOut = new ZipOutputStream(cos);</div><div class="line">            String baseDir = &quot;&quot;;</div><div class="line">            compress(srcFile, zipOut, baseDir);</div><div class="line">        &#125;</div><div class="line">        finally &#123;</div><div class="line">            if(null != zipOut)&#123;</div><div class="line">                zipOut.close();</div><div class="line">                out = null;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if(null != out)&#123;</div><div class="line">                out.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    private static void compress(File file, ZipOutputStream zipOut, String baseDir) throws IOException&#123;</div><div class="line">        if (file.isDirectory()) &#123;</div><div class="line">            compressDirectory(file, zipOut, baseDir);</div><div class="line">        &#125; else &#123;</div><div class="line">            compressFile(file, zipOut, baseDir);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /** 压缩一个目录 */</div><div class="line">    private static void compressDirectory(File dir, ZipOutputStream zipOut, String baseDir) throws IOException&#123;</div><div class="line">        File[] files = dir.listFiles();</div><div class="line">        for (int i = 0; i &lt; files.length; i++) &#123;</div><div class="line">            compress(files[i], zipOut, baseDir + dir.getName() + &quot;/&quot;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /** 压缩一个文件 */</div><div class="line">    private static void compressFile(File file, ZipOutputStream zipOut, String baseDir)  throws IOException&#123;</div><div class="line">        if (!file.exists())&#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        BufferedInputStream bis = null;</div><div class="line">        try &#123;</div><div class="line">            bis = new BufferedInputStream(new FileInputStream(file));</div><div class="line">            ZipEntry entry = new ZipEntry(baseDir + file.getName());</div><div class="line">            zipOut.putNextEntry(entry);</div><div class="line">            int count;</div><div class="line">            byte data[] = new byte[BUFFER];</div><div class="line">            while ((count = bis.read(data, 0, BUFFER)) != -1) &#123;</div><div class="line">                zipOut.write(data, 0, count);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;finally &#123;</div><div class="line">            if(null != bis)&#123;</div><div class="line">                bis.close();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    public static void decompress(String zipFile , String dstPath)throws IOException&#123;</div><div class="line">        File pathFile = new File(dstPath);</div><div class="line">        if(!pathFile.exists())&#123;</div><div class="line">            pathFile.mkdirs();</div><div class="line">        &#125;</div><div class="line">        ZipFile zip = new ZipFile(zipFile);</div><div class="line">        for(Enumeration entries = zip.entries(); entries.hasMoreElements();)&#123;</div><div class="line">            ZipEntry entry = (ZipEntry)entries.nextElement();</div><div class="line">            String zipEntryName = entry.getName();</div><div class="line">            InputStream in = null;</div><div class="line">            OutputStream out = null;</div><div class="line">            try&#123;</div><div class="line">                in =  zip.getInputStream(entry);</div><div class="line">                String outPath = (dstPath+&quot;/&quot;+zipEntryName).replaceAll(&quot;\\*&quot;, &quot;/&quot;);;</div><div class="line">                //判断路径是否存在,不存在则创建文件路径</div><div class="line">                File file = new File(outPath.substring(0, outPath.lastIndexOf(&apos;/&apos;)));</div><div class="line">                if(!file.exists())&#123;</div><div class="line">                    file.mkdirs();</div><div class="line">                &#125;</div><div class="line">                //判断文件全路径是否为文件夹,如果是上面已经上传,不需要解压</div><div class="line">                if(new File(outPath).isDirectory())&#123;</div><div class="line">                    continue;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                out = new FileOutputStream(outPath);</div><div class="line">                byte[] buf1 = new byte[1024];</div><div class="line">                int len;</div><div class="line">                while((len=in.read(buf1))&gt;0)&#123;</div><div class="line">                    out.write(buf1,0,len);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            finally &#123;</div><div class="line">                if(null != in)&#123;</div><div class="line">                    in.close();</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                if(null != out)&#123;</div><div class="line">                    out.close();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="图片添加水印"><a href="#图片添加水印" class="headerlink" title="图片添加水印"></a>图片添加水印</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div></pre></td><td class="code"><pre><div class="line">import java.awt.AlphaComposite;</div><div class="line">import java.awt.Graphics2D;</div><div class="line">import java.awt.Image;</div><div class="line">import java.awt.RenderingHints;</div><div class="line">import java.awt.image.BufferedImage;</div><div class="line">import java.io.File;</div><div class="line">import java.io.FileOutputStream;</div><div class="line">import java.io.OutputStream;</div><div class="line"></div><div class="line">import javax.imageio.ImageIO;</div><div class="line">import javax.swing.ImageIcon;</div><div class="line"></div><div class="line">public class ImageMarkLogoByIcon &#123;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 给图片添加水印</div><div class="line">     * @param iconPath 水印图片路径</div><div class="line">     * @param srcImgPath 源图片路径</div><div class="line">     * @param targerPath 目标图片路径</div><div class="line">     */</div><div class="line">    public static void markImageByIcon(String iconPath, String srcImgPath,</div><div class="line">                                       String targerPath) &#123;</div><div class="line">        markImageByIcon(iconPath, srcImgPath, targerPath, null);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 给图片添加水印、可设置水印图片旋转角度</div><div class="line">     * @param iconPath 水印图片路径</div><div class="line">     * @param srcImgPath 源图片路径</div><div class="line">     * @param targerPath 目标图片路径</div><div class="line">     * @param degree 水印图片旋转角度</div><div class="line">     */</div><div class="line">    public static void markImageByIcon(String iconPath, String srcImgPath,</div><div class="line">                                       String targerPath, Integer degree) &#123;</div><div class="line">        OutputStream os = null;</div><div class="line">        try &#123;</div><div class="line">            Image srcImg = ImageIO.read(new File(srcImgPath));</div><div class="line"></div><div class="line">            BufferedImage buffImg = new BufferedImage(srcImg.getWidth(null),</div><div class="line">                    srcImg.getHeight(null), BufferedImage.TYPE_INT_RGB);</div><div class="line"></div><div class="line">            // 得到画笔对象</div><div class="line">            // Graphics g= buffImg.getGraphics();</div><div class="line">            Graphics2D g = buffImg.createGraphics();</div><div class="line"></div><div class="line">            // 设置对线段的锯齿状边缘处理</div><div class="line">            g.setRenderingHint(RenderingHints.KEY_INTERPOLATION,</div><div class="line">                    RenderingHints.VALUE_INTERPOLATION_BILINEAR);</div><div class="line"></div><div class="line">            g.drawImage(srcImg.getScaledInstance(srcImg.getWidth(null), srcImg</div><div class="line">                    .getHeight(null), Image.SCALE_SMOOTH), 0, 0, null);</div><div class="line"></div><div class="line">            if (null != degree) &#123;</div><div class="line">                // 设置水印旋转</div><div class="line">                g.rotate(Math.toRadians(degree),</div><div class="line">                        (double) buffImg.getWidth() / 2, (double) buffImg</div><div class="line">                                .getHeight() / 2);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            // 水印图象的路径 水印一般为gif或者png的，这样可设置透明度</div><div class="line">            ImageIcon imgIcon = new ImageIcon(iconPath);</div><div class="line"></div><div class="line">            // 得到Image对象。</div><div class="line">            Image img = imgIcon.getImage();</div><div class="line"></div><div class="line">            float alpha = 0.5f; // 透明度</div><div class="line">            g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_ATOP,</div><div class="line">                    alpha));</div><div class="line"></div><div class="line">            // 表示水印图片的位置</div><div class="line">            g.drawImage(img, 150, 300, null);</div><div class="line"></div><div class="line">            g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER));</div><div class="line"></div><div class="line">            g.dispose();</div><div class="line"></div><div class="line">            os = new FileOutputStream(targerPath);</div><div class="line"></div><div class="line">            // 生成图片</div><div class="line">            ImageIO.write(buffImg, &quot;JPG&quot;, os);</div><div class="line"></div><div class="line">            System.out.println(&quot;图片完成添加Icon印章。。。。。。&quot;);</div><div class="line">        &#125; catch (Exception e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; finally &#123;</div><div class="line">            try &#123;</div><div class="line">                if (null != os)</div><div class="line">                    os.close();</div><div class="line">            &#125; catch (Exception e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    页阅读量:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    站访问量:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    站访客数:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>




    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>

<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.min.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
