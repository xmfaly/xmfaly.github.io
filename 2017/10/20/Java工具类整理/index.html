<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  
  <title>Java工具类整理</title>
  <meta name="author" content="xmfaly">
  <meta name="description" content="以下整理常用的java工具类。
二维码生成和解析(网上很多接口也很方便)使用google的zxing12345&amp;lt;dependency&amp;gt;	&amp;lt;groupId&amp;gt;com.google.zxing&amp;lt;/groupId&amp;gt;	&amp;lt;artifactId&amp;gt;javase&amp;lt;">
  
  
  <meta property="og:title" content="Java工具类整理"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="惜凡"/>
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="惜凡" type="application/atom+xml">
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>

<body>
  <a id="top"></a>
  <div id="main">
    <div class="behind">
      <a href="/" class="back black-color">
        <svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
            <path d="M2 30 L30 2 M30 30 L2 2"></path>
        </svg>
      </a>
      <div class="description">
        &nbsp;
      </div>
    </div>
    <div class="container">
      

  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        Java工具类整理
    </h1>
  


    </div>
    <div class="meta center">
      
<time datetime="2017-10-20T15:50:16.000Z">
<svg class="i-calendar" viewBox="0 0 32 32" width="14" height="14" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
    <path d="M2 6 L2 30 30 30 30 6 Z M2 15 L30 15 M7 3 L7 9 M13 3 L13 9 M19 3 L19 9 M25 3 L25 9"></path>
  </svg>
  &nbsp;
  2017-10-20
</time>






    
    &nbsp;
    <svg class="i-tag" viewBox="0 0 32 32" width="14" height="14" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      <circle cx="24" cy="8" r="2"></circle>
      <path d="M2 18 L18 2 30 2 30 14 14 30 Z"></path>
    </svg>
    &nbsp;
    <a href="/tags/java/">java</a>


    </div>
    <hr>
    <div class="picture-container">
      
    </div>
    <p>以下整理常用的java工具类。</p>
<h3 id="二维码生成和解析-网上很多接口也很方便"><a href="#二维码生成和解析-网上很多接口也很方便" class="headerlink" title="二维码生成和解析(网上很多接口也很方便)"></a>二维码生成和解析(网上很多接口也很方便)</h3><p>使用google的zxing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;com.google.zxing&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;javase&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;3.3.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>工具类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">import com.google.zxing.*;</span><br><span class="line">import com.google.zxing.Reader;</span><br><span class="line">import com.google.zxing.client.j2se.BufferedImageLuminanceSource;</span><br><span class="line">import com.google.zxing.client.j2se.MatrixToImageWriter;</span><br><span class="line">import com.google.zxing.common.BitMatrix;</span><br><span class="line">import com.google.zxing.common.HybridBinarizer;</span><br><span class="line">import com.google.zxing.multi.GenericMultipleBarcodeReader;</span><br><span class="line">import com.google.zxing.multi.MultipleBarcodeReader;</span><br><span class="line"></span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.nio.file.FileSystems;</span><br><span class="line">import java.nio.file.Path;</span><br><span class="line">import java.util.*;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 二维码生成工具类</span><br><span class="line"> *</span><br><span class="line"> * @author KisChang</span><br><span class="line"> * @version 1.0</span><br><span class="line"> * @date 2015年12月03日</span><br><span class="line"> * @since 1.0</span><br><span class="line"> */</span><br><span class="line">public class ZXingUtils &#123;</span><br><span class="line"></span><br><span class="line">    public static enum ImageType &#123;</span><br><span class="line">        JPEG(&quot;jpeg&quot;),PNG(&quot;png&quot;),GIF(&quot;gif&quot;);</span><br><span class="line">        private String value;</span><br><span class="line"></span><br><span class="line">        ImageType(String value) &#123;</span><br><span class="line">            this.value = value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public String getValue() &#123;</span><br><span class="line">            return value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**编码*/</span><br><span class="line">    public static class Encode &#123;</span><br><span class="line"></span><br><span class="line">        private static Map&lt;EncodeHintType, Object&gt; HINTS;</span><br><span class="line">        static &#123;</span><br><span class="line">            HINTS = new EnumMap&lt;EncodeHintType,Object&gt;(EncodeHintType.class);</span><br><span class="line">            HINTS.put(EncodeHintType.CHARACTER_SET, &quot;UTF-8&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        /**</span><br><span class="line">         * 生成二维码</span><br><span class="line">         * @param widthAndHeight    高宽</span><br><span class="line">         * @param content           二维码内容</span><br><span class="line">         * @param os                输出流</span><br><span class="line">         */</span><br><span class="line">        public static void buildQRCode(int widthAndHeight, String content, OutputStream os, ImageType imageType) throws WriterException, IOException &#123;</span><br><span class="line">            BitMatrix bitMatrix = new MultiFormatWriter().encode(content, BarcodeFormat.QR_CODE, widthAndHeight, widthAndHeight, HINTS);// 生成矩阵</span><br><span class="line">            MatrixToImageWriter.writeToStream(bitMatrix, imageType.getValue(), os);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static void buildQRCode(String content, OutputStream os, ImageType imageType) throws WriterException, IOException &#123;</span><br><span class="line">            buildQRCode(200, content, os, imageType);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">         * 生成二维码</span><br><span class="line">         * @param widthAndHeight    高宽</span><br><span class="line">         * @param content           二维码内容</span><br><span class="line">         * @param filePath          输出目录</span><br><span class="line">         * @param fileName          输出文件名</span><br><span class="line">         * @param imageType         输出文件类型</span><br><span class="line">         */</span><br><span class="line">        public static void buildQRCode(int widthAndHeight, String content, String filePath, String fileName, ImageType imageType) throws WriterException, IOException &#123;</span><br><span class="line">            BitMatrix bitMatrix = new MultiFormatWriter().encode(content,</span><br><span class="line">                    BarcodeFormat.QR_CODE, widthAndHeight, widthAndHeight, HINTS);</span><br><span class="line">            Path path = FileSystems.getDefault().getPath(filePath, fileName);</span><br><span class="line">            MatrixToImageWriter.writeToPath(bitMatrix, imageType.getValue(), path);// 输出图像</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static void buildQRCode(String content, String filePath, String fileName, ImageType imageType) throws WriterException, IOException &#123;</span><br><span class="line">            buildQRCode(200, content,filePath,fileName,imageType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**解码*/</span><br><span class="line">    public static class Decode &#123;</span><br><span class="line"></span><br><span class="line">        private static final Map&lt;DecodeHintType,Object&gt; HINTS;</span><br><span class="line">        private static final Map&lt;DecodeHintType,Object&gt; HINTS_PURE;</span><br><span class="line">        static &#123;</span><br><span class="line">            HINTS = new EnumMap&lt;DecodeHintType,Object&gt;(DecodeHintType.class);</span><br><span class="line">            HINTS.put(DecodeHintType.TRY_HARDER, Boolean.TRUE);</span><br><span class="line">            HINTS.put(DecodeHintType.POSSIBLE_FORMATS, EnumSet.allOf(BarcodeFormat.class));</span><br><span class="line">            HINTS_PURE = new EnumMap&lt;DecodeHintType,Object&gt;(HINTS);</span><br><span class="line">            HINTS_PURE.put(DecodeHintType.PURE_BARCODE, Boolean.TRUE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">         * 解析二维码</span><br><span class="line">         */</span><br><span class="line">        public static Collection&lt;Result&gt; readQRCode(File qrCode) throws ReaderException, IOException &#123;</span><br><span class="line">            FileInputStream inputStream = new FileInputStream(qrCode);</span><br><span class="line">            return readQRCode(inputStream);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static Collection&lt;Result&gt; readQRCode(InputStream inputStream) throws ReaderException, IOException &#123;</span><br><span class="line">            LuminanceSource source = new BufferedImageLuminanceSource(ImageIO.read(inputStream));</span><br><span class="line">            BinaryBitmap binaryBitmap = new BinaryBitmap(new HybridBinarizer(source));</span><br><span class="line"></span><br><span class="line">            Collection&lt;Result&gt; results = new ArrayList&lt;Result&gt;(1);</span><br><span class="line">            ReaderException savedException = null;</span><br><span class="line">            Reader reader = new MultiFormatReader();</span><br><span class="line">            try &#123;</span><br><span class="line">                //寻找多个条码</span><br><span class="line">                MultipleBarcodeReader multiReader = new GenericMultipleBarcodeReader(reader);</span><br><span class="line">                Result[] theResults = multiReader.decodeMultiple(binaryBitmap, HINTS);</span><br><span class="line">                if (theResults != null) &#123;</span><br><span class="line">                    results.addAll(Arrays.asList(theResults));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (ReaderException re) &#123;</span><br><span class="line">                savedException = re;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (results.isEmpty()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    //寻找纯条码</span><br><span class="line">                    Result theResult = reader.decode(binaryBitmap, HINTS_PURE);</span><br><span class="line">                    if (theResult != null) &#123;</span><br><span class="line">                        results.add(theResult);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (ReaderException re) &#123;</span><br><span class="line">                    savedException = re;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (results.isEmpty()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    //寻找图片中的正常条码</span><br><span class="line">                    Result theResult = reader.decode(binaryBitmap, HINTS);</span><br><span class="line">                    if (theResult != null) &#123;</span><br><span class="line">                        results.add(theResult);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (ReaderException re) &#123;</span><br><span class="line">                    savedException = re;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (results.isEmpty()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    //再次尝试其他特殊处理</span><br><span class="line">                    BinaryBitmap hybridBitmap = new BinaryBitmap(new HybridBinarizer(source));</span><br><span class="line">                    Result theResult = reader.decode(hybridBitmap, HINTS);</span><br><span class="line">                    if (theResult != null) &#123;</span><br><span class="line">                        results.add(theResult);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (ReaderException re) &#123;</span><br><span class="line">                    savedException = re;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (results.isEmpty())&#123;</span><br><span class="line">                throw savedException;</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                return results;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        public static Result readQRCodeResult(File qrCode) throws ReaderException, IOException &#123;</span><br><span class="line">            FileInputStream inputStream = new FileInputStream(qrCode);</span><br><span class="line">            return readQRCodeResult(inputStream);</span><br><span class="line">        &#125;</span><br><span class="line">        public static Result readQRCodeResult(InputStream inputStream) throws ReaderException, IOException &#123;</span><br><span class="line">            Collection&lt;Result&gt; results = readQRCode(inputStream);</span><br><span class="line">            if (!results.isEmpty())&#123;</span><br><span class="line">                //寻找结果集中非空的结果</span><br><span class="line">                for (Result result : results)&#123;</span><br><span class="line">                    if (result != null)&#123;</span><br><span class="line">                        return result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            throw NotFoundException.getNotFoundInstance();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MD5加密"><a href="#MD5加密" class="headerlink" title="MD5加密"></a>MD5加密</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import java.math.BigInteger;</span><br><span class="line">import java.security.MessageDigest;</span><br><span class="line">import java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line">public class MD5 &#123;</span><br><span class="line"></span><br><span class="line">    public static String getMD5(String str) throws NoSuchAlgorithmException &#123;</span><br><span class="line"></span><br><span class="line">        // 生成一个MD5加密计算摘要</span><br><span class="line">        MessageDigest md = MessageDigest.getInstance(&quot;MD5&quot;);</span><br><span class="line">        // 计算md5函数</span><br><span class="line">        md.update(str.getBytes());</span><br><span class="line">        // digest()最后确定返回md5 hash值，返回值为8为字符串。因为md5 hash值是16位的hex值，实际上就是8位的字符</span><br><span class="line">        // BigInteger函数则将8位的字符串转换成16位hex值，用字符串来表示；得到字符串形式的hash值</span><br><span class="line">        return new BigInteger(1, md.digest()).toString(16);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="读取excel"><a href="#读取excel" class="headerlink" title="读取excel"></a>读取excel</h3><p>依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.17-beta1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;!-- https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml --&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.16-beta1&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>工具类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">import org.apache.poi.hssf.usermodel.HSSFWorkbook;</span><br><span class="line">import org.apache.poi.ss.usermodel.*;</span><br><span class="line">import org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.text.DecimalFormat;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.HashMap;</span><br><span class="line">import java.util.Map;</span><br><span class="line">public class ReadExcelUtils &#123;</span><br><span class="line"></span><br><span class="line">    private Logger logger = LoggerFactory.getLogger(this.getClass());</span><br><span class="line">    private Workbook wb;</span><br><span class="line">    private Sheet sheet;</span><br><span class="line">    private Row row;</span><br><span class="line">    public ReadExcelUtils(String filepath) &#123;</span><br><span class="line">        if(filepath==null)&#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        String ext = filepath.substring(filepath.lastIndexOf(&quot;.&quot;));</span><br><span class="line">        try &#123;</span><br><span class="line">            InputStream is = new FileInputStream(filepath);</span><br><span class="line">            if(&quot;.xls&quot;.equals(ext))&#123;</span><br><span class="line">                wb = new HSSFWorkbook(is);</span><br><span class="line">            &#125;else if(&quot;.xlsx&quot;.equals(ext))&#123;</span><br><span class="line">                wb = new XSSFWorkbook(is);</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                wb=null;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            logger.error(&quot;FileNotFoundException&quot;, e);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            logger.error(&quot;IOException&quot;, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 读取Excel表格表头的内容</span><br><span class="line">     * @return String 表头内容的数组</span><br><span class="line">     */</span><br><span class="line">    public String[] readExcelTitle() throws Exception&#123;</span><br><span class="line">        if(wb==null)&#123;</span><br><span class="line">            throw new Exception(&quot;Workbook对象为空！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        sheet = wb.getSheetAt(0);</span><br><span class="line">        row = sheet.getRow(0);</span><br><span class="line">        // 标题总列数</span><br><span class="line">        int colNum = row.getPhysicalNumberOfCells();</span><br><span class="line">        String[] title = new String[colNum];</span><br><span class="line">        for (int i = 0; i &lt; colNum; i++) &#123;</span><br><span class="line">            // title[i] = getStringCellValue(row.getCell((short) i));</span><br><span class="line">            title[i] = row.getCell(i).getStringCellValue();</span><br><span class="line">        &#125;</span><br><span class="line">        return title;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 读取Excel数据内容</span><br><span class="line">     * @return Map 包含单元格数据内容的Map对象</span><br><span class="line">     */</span><br><span class="line">    public Map&lt;Integer, Map&lt;Integer,Object&gt;&gt; readExcelContent() throws Exception&#123;</span><br><span class="line">        if(wb==null)&#123;</span><br><span class="line">            throw new Exception(&quot;Workbook对象为空！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;Integer, Map&lt;Integer,Object&gt;&gt; content = new HashMap&lt;Integer, Map&lt;Integer,Object&gt;&gt;();</span><br><span class="line">        sheet = wb.getSheetAt(0);</span><br><span class="line">        // 得到总行数</span><br><span class="line">        int rowNum = sheet.getLastRowNum();</span><br><span class="line">        row = sheet.getRow(0);</span><br><span class="line">        int colNum = row.getPhysicalNumberOfCells();</span><br><span class="line">        // 正文内容应该从第二行开始,第一行为表头的标题</span><br><span class="line">        for (int i = 1; i &lt;= rowNum; i++) &#123;</span><br><span class="line">            row = sheet.getRow(i);</span><br><span class="line">            int j = 0;</span><br><span class="line">            Map&lt;Integer,Object&gt; cellValue = new HashMap&lt;Integer, Object&gt;();</span><br><span class="line">            while (j &lt; colNum) &#123;</span><br><span class="line">                Object obj = getCellFormatValue(row.getCell(j));</span><br><span class="line">                cellValue.put(j, obj);</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            content.put(i, cellValue);</span><br><span class="line">        &#125;</span><br><span class="line">        return content;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 根据Cell类型设置数据</span><br><span class="line">     * @param cell</span><br><span class="line">     * @return Object</span><br><span class="line">     */</span><br><span class="line">    private Object getCellFormatValue(Cell cell) &#123;</span><br><span class="line">        Object cellvalue = &quot;&quot;;</span><br><span class="line">        if (cell != null) &#123;</span><br><span class="line">            // 判断当前Cell的Type</span><br><span class="line">            switch (cell.getCellType()) &#123;</span><br><span class="line">                case Cell.CELL_TYPE_NUMERIC:// 如果当前Cell的Type为NUMERIC</span><br><span class="line">                case Cell.CELL_TYPE_FORMULA: &#123;</span><br><span class="line">                    // 判断当前的cell是否为Date</span><br><span class="line">                    if (DateUtil.isCellDateFormatted(cell)) &#123;</span><br><span class="line">                        Date date = cell.getDateCellValue();</span><br><span class="line">                        SimpleDateFormat dateformat=new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class="line">                        cellvalue = dateformat.format(date);</span><br><span class="line"></span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        // 如果是纯数字</span><br><span class="line">                        // 取得当前Cell的数值</span><br><span class="line">                        DecimalFormat df = new DecimalFormat(&quot;0&quot;);</span><br><span class="line">                        cellvalue = df.format(cell.getNumericCellValue());</span><br><span class="line">                    &#125;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                case Cell.CELL_TYPE_STRING:// 如果当前Cell的Type为STRING</span><br><span class="line">                    // 取得当前的Cell字符串</span><br><span class="line">                    cellvalue = cell.getRichStringCellValue().getString();</span><br><span class="line">                    break;</span><br><span class="line">                default:// 默认的Cell值</span><br><span class="line">                    cellvalue = &quot;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            cellvalue = &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return cellvalue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="加密工具类"><a href="#加密工具类" class="headerlink" title="加密工具类"></a>加密工具类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">import java.security.Key;</span><br><span class="line">import java.security.spec.AlgorithmParameterSpec;</span><br><span class="line"></span><br><span class="line">import javax.crypto.Cipher;</span><br><span class="line">import javax.crypto.SecretKeyFactory;</span><br><span class="line">import javax.crypto.spec.DESKeySpec;</span><br><span class="line">import javax.crypto.spec.IvParameterSpec;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 加密解密工具包</span><br><span class="line"> */</span><br><span class="line">public class CyptoUtils &#123;</span><br><span class="line"></span><br><span class="line">    public static final String ALGORITHM_DES = &quot;DES/CBC/PKCS5Padding&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * DES算法，加密</span><br><span class="line">     *</span><br><span class="line">     * @param data 待加密字符串</span><br><span class="line">     * @param key  加密私钥，长度不能够小于8位</span><br><span class="line">     * @return 加密后的字节数组，一般结合Base64编码使用</span><br><span class="line">     * @throws Exception</span><br><span class="line">     */</span><br><span class="line">    public static String encode(String key,String data) &#123;</span><br><span class="line">        if(data == null)</span><br><span class="line">            return null;</span><br><span class="line">        try&#123;</span><br><span class="line">            DESKeySpec dks = new DESKeySpec(key.getBytes());</span><br><span class="line">            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;DES&quot;);</span><br><span class="line">            //key的长度不能够小于8位字节</span><br><span class="line">            Key secretKey = keyFactory.generateSecret(dks);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(ALGORITHM_DES);</span><br><span class="line">            IvParameterSpec iv = new IvParameterSpec(&quot;12345678&quot;.getBytes());</span><br><span class="line">            AlgorithmParameterSpec paramSpec = iv;</span><br><span class="line">            cipher.init(Cipher.ENCRYPT_MODE, secretKey,paramSpec);</span><br><span class="line">            byte[] bytes = cipher.doFinal(data.getBytes());</span><br><span class="line">            return byte2hex(bytes);</span><br><span class="line">        &#125;catch(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * DES算法，解密</span><br><span class="line">     *</span><br><span class="line">     * @param data 待解密字符串</span><br><span class="line">     * @param key  解密私钥，长度不能够小于8位</span><br><span class="line">     * @return 解密后的字节数组</span><br><span class="line">     * @throws Exception 异常</span><br><span class="line">     */</span><br><span class="line">    public static String decode(String key,String data) &#123;</span><br><span class="line">        if(data == null)</span><br><span class="line">            return null;</span><br><span class="line">        try &#123;</span><br><span class="line">            DESKeySpec dks = new DESKeySpec(key.getBytes());</span><br><span class="line">            SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;DES&quot;);</span><br><span class="line">            //key的长度不能够小于8位字节</span><br><span class="line">            Key secretKey = keyFactory.generateSecret(dks);</span><br><span class="line">            Cipher cipher = Cipher.getInstance(ALGORITHM_DES);</span><br><span class="line">            IvParameterSpec iv = new IvParameterSpec(&quot;12345678&quot;.getBytes());</span><br><span class="line">            AlgorithmParameterSpec paramSpec = iv;</span><br><span class="line">            cipher.init(Cipher.DECRYPT_MODE, secretKey, paramSpec);</span><br><span class="line">            return new String(cipher.doFinal(hex2byte(data.getBytes())));</span><br><span class="line">        &#125; catch (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            return data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 二行制转字符串</span><br><span class="line">     * @param b</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    private static String byte2hex(byte[] b) &#123;</span><br><span class="line">        StringBuilder hs = new StringBuilder();</span><br><span class="line">        String stmp;</span><br><span class="line">        for (int n = 0; b!=null &amp;&amp; n &lt; b.length; n++) &#123;</span><br><span class="line">            stmp = Integer.toHexString(b[n] &amp; 0XFF);</span><br><span class="line">            if (stmp.length() == 1)</span><br><span class="line">                hs.append(&apos;0&apos;);</span><br><span class="line">            hs.append(stmp);</span><br><span class="line">        &#125;</span><br><span class="line">        return hs.toString().toUpperCase();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static byte[] hex2byte(byte[] b) &#123;</span><br><span class="line">        if((b.length%2)!=0)</span><br><span class="line">            throw new IllegalArgumentException();</span><br><span class="line">        byte[] b2 = new byte[b.length/2];</span><br><span class="line">        for (int n = 0; n &lt; b.length; n+=2) &#123;</span><br><span class="line">            String item = new String(b,n,2);</span><br><span class="line">            b2[n/2] = (byte)Integer.parseInt(item,16);</span><br><span class="line">        &#125;</span><br><span class="line">        return b2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="压缩解压"><a href="#压缩解压" class="headerlink" title="压缩解压"></a>压缩解压</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">import java.io.*;</span><br><span class="line">import java.util.Enumeration;</span><br><span class="line">import java.util.zip.*;</span><br><span class="line"></span><br><span class="line">public class CompressUtil &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    static final int BUFFER = 8192;</span><br><span class="line"></span><br><span class="line">    public static void compress(String srcPath , String dstPath) throws IOException &#123;</span><br><span class="line">        File srcFile = new File(srcPath);</span><br><span class="line">        File dstFile = new File(dstPath);</span><br><span class="line">        if (!srcFile.exists()) &#123;</span><br><span class="line">            throw new FileNotFoundException(srcPath + &quot;不存在！&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FileOutputStream out = null;</span><br><span class="line">        ZipOutputStream zipOut = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            out = new FileOutputStream(dstFile);</span><br><span class="line">            CheckedOutputStream cos = new CheckedOutputStream(out,new CRC32());</span><br><span class="line">            zipOut = new ZipOutputStream(cos);</span><br><span class="line">            String baseDir = &quot;&quot;;</span><br><span class="line">            compress(srcFile, zipOut, baseDir);</span><br><span class="line">        &#125;</span><br><span class="line">        finally &#123;</span><br><span class="line">            if(null != zipOut)&#123;</span><br><span class="line">                zipOut.close();</span><br><span class="line">                out = null;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if(null != out)&#123;</span><br><span class="line">                out.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static void compress(File file, ZipOutputStream zipOut, String baseDir) throws IOException&#123;</span><br><span class="line">        if (file.isDirectory()) &#123;</span><br><span class="line">            compressDirectory(file, zipOut, baseDir);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            compressFile(file, zipOut, baseDir);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /** 压缩一个目录 */</span><br><span class="line">    private static void compressDirectory(File dir, ZipOutputStream zipOut, String baseDir) throws IOException&#123;</span><br><span class="line">        File[] files = dir.listFiles();</span><br><span class="line">        for (int i = 0; i &lt; files.length; i++) &#123;</span><br><span class="line">            compress(files[i], zipOut, baseDir + dir.getName() + &quot;/&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /** 压缩一个文件 */</span><br><span class="line">    private static void compressFile(File file, ZipOutputStream zipOut, String baseDir)  throws IOException&#123;</span><br><span class="line">        if (!file.exists())&#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BufferedInputStream bis = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            bis = new BufferedInputStream(new FileInputStream(file));</span><br><span class="line">            ZipEntry entry = new ZipEntry(baseDir + file.getName());</span><br><span class="line">            zipOut.putNextEntry(entry);</span><br><span class="line">            int count;</span><br><span class="line">            byte data[] = new byte[BUFFER];</span><br><span class="line">            while ((count = bis.read(data, 0, BUFFER)) != -1) &#123;</span><br><span class="line">                zipOut.write(data, 0, count);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            if(null != bis)&#123;</span><br><span class="line">                bis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void decompress(String zipFile , String dstPath)throws IOException&#123;</span><br><span class="line">        File pathFile = new File(dstPath);</span><br><span class="line">        if(!pathFile.exists())&#123;</span><br><span class="line">            pathFile.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">        ZipFile zip = new ZipFile(zipFile);</span><br><span class="line">        for(Enumeration entries = zip.entries(); entries.hasMoreElements();)&#123;</span><br><span class="line">            ZipEntry entry = (ZipEntry)entries.nextElement();</span><br><span class="line">            String zipEntryName = entry.getName();</span><br><span class="line">            InputStream in = null;</span><br><span class="line">            OutputStream out = null;</span><br><span class="line">            try&#123;</span><br><span class="line">                in =  zip.getInputStream(entry);</span><br><span class="line">                String outPath = (dstPath+&quot;/&quot;+zipEntryName).replaceAll(&quot;\\*&quot;, &quot;/&quot;);;</span><br><span class="line">                //判断路径是否存在,不存在则创建文件路径</span><br><span class="line">                File file = new File(outPath.substring(0, outPath.lastIndexOf(&apos;/&apos;)));</span><br><span class="line">                if(!file.exists())&#123;</span><br><span class="line">                    file.mkdirs();</span><br><span class="line">                &#125;</span><br><span class="line">                //判断文件全路径是否为文件夹,如果是上面已经上传,不需要解压</span><br><span class="line">                if(new File(outPath).isDirectory())&#123;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                out = new FileOutputStream(outPath);</span><br><span class="line">                byte[] buf1 = new byte[1024];</span><br><span class="line">                int len;</span><br><span class="line">                while((len=in.read(buf1))&gt;0)&#123;</span><br><span class="line">                    out.write(buf1,0,len);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            finally &#123;</span><br><span class="line">                if(null != in)&#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if(null != out)&#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="图片添加水印"><a href="#图片添加水印" class="headerlink" title="图片添加水印"></a>图片添加水印</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">import java.awt.AlphaComposite;</span><br><span class="line">import java.awt.Graphics2D;</span><br><span class="line">import java.awt.Image;</span><br><span class="line">import java.awt.RenderingHints;</span><br><span class="line">import java.awt.image.BufferedImage;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line"></span><br><span class="line">import javax.imageio.ImageIO;</span><br><span class="line">import javax.swing.ImageIcon;</span><br><span class="line"></span><br><span class="line">public class ImageMarkLogoByIcon &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 给图片添加水印</span><br><span class="line">     * @param iconPath 水印图片路径</span><br><span class="line">     * @param srcImgPath 源图片路径</span><br><span class="line">     * @param targerPath 目标图片路径</span><br><span class="line">     */</span><br><span class="line">    public static void markImageByIcon(String iconPath, String srcImgPath,</span><br><span class="line">                                       String targerPath) &#123;</span><br><span class="line">        markImageByIcon(iconPath, srcImgPath, targerPath, null);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 给图片添加水印、可设置水印图片旋转角度</span><br><span class="line">     * @param iconPath 水印图片路径</span><br><span class="line">     * @param srcImgPath 源图片路径</span><br><span class="line">     * @param targerPath 目标图片路径</span><br><span class="line">     * @param degree 水印图片旋转角度</span><br><span class="line">     */</span><br><span class="line">    public static void markImageByIcon(String iconPath, String srcImgPath,</span><br><span class="line">                                       String targerPath, Integer degree) &#123;</span><br><span class="line">        OutputStream os = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            Image srcImg = ImageIO.read(new File(srcImgPath));</span><br><span class="line"></span><br><span class="line">            BufferedImage buffImg = new BufferedImage(srcImg.getWidth(null),</span><br><span class="line">                    srcImg.getHeight(null), BufferedImage.TYPE_INT_RGB);</span><br><span class="line"></span><br><span class="line">            // 得到画笔对象</span><br><span class="line">            // Graphics g= buffImg.getGraphics();</span><br><span class="line">            Graphics2D g = buffImg.createGraphics();</span><br><span class="line"></span><br><span class="line">            // 设置对线段的锯齿状边缘处理</span><br><span class="line">            g.setRenderingHint(RenderingHints.KEY_INTERPOLATION,</span><br><span class="line">                    RenderingHints.VALUE_INTERPOLATION_BILINEAR);</span><br><span class="line"></span><br><span class="line">            g.drawImage(srcImg.getScaledInstance(srcImg.getWidth(null), srcImg</span><br><span class="line">                    .getHeight(null), Image.SCALE_SMOOTH), 0, 0, null);</span><br><span class="line"></span><br><span class="line">            if (null != degree) &#123;</span><br><span class="line">                // 设置水印旋转</span><br><span class="line">                g.rotate(Math.toRadians(degree),</span><br><span class="line">                        (double) buffImg.getWidth() / 2, (double) buffImg</span><br><span class="line">                                .getHeight() / 2);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // 水印图象的路径 水印一般为gif或者png的，这样可设置透明度</span><br><span class="line">            ImageIcon imgIcon = new ImageIcon(iconPath);</span><br><span class="line"></span><br><span class="line">            // 得到Image对象。</span><br><span class="line">            Image img = imgIcon.getImage();</span><br><span class="line"></span><br><span class="line">            float alpha = 0.5f; // 透明度</span><br><span class="line">            g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_ATOP,</span><br><span class="line">                    alpha));</span><br><span class="line"></span><br><span class="line">            // 表示水印图片的位置</span><br><span class="line">            g.drawImage(img, 150, 300, null);</span><br><span class="line"></span><br><span class="line">            g.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER));</span><br><span class="line"></span><br><span class="line">            g.dispose();</span><br><span class="line"></span><br><span class="line">            os = new FileOutputStream(targerPath);</span><br><span class="line"></span><br><span class="line">            // 生成图片</span><br><span class="line">            ImageIO.write(buffImg, &quot;JPG&quot;, os);</span><br><span class="line"></span><br><span class="line">            System.out.println(&quot;图片完成添加Icon印章。。。。。。&quot;);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                if (null != os)</span><br><span class="line">                    os.close();</span><br><span class="line">            &#125; catch (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  </article>
  </script>
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <div class="busuanzi center">
    page PV:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    site PV:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    site UV:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>




    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>

<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.min.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
